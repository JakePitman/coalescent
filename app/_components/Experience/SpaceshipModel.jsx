/*
Auto-generated by: https://github.com/pmndrs/gltfjsx
Command: npx gltfjsx@6.2.16 public/spaceship-model-glass.glb 
*/

import { useGLTF, useTexture } from "@react-three/drei";
import { ColorShiftMaterial } from "./Light";
import { useThree } from "@react-three/fiber";
import { MeshPhysicalMaterial } from "three";

const glassMaterial = new MeshPhysicalMaterial({
  metalness: 0,
  depthTest: false,
  depthWrite: false,
  transmission: 1,
  thickness: 0,
  roughness: 0,
  envMapIntensity: 0.3,
});

export function Model(props) {
  const { clock } = useThree();
  const shipTexture = useTexture("/baked/baked-ship-8192.jpg");
  shipTexture.flipY = false;
  const consoleTexture = useTexture("/baked/baked-console-4096.jpg");
  consoleTexture.flipY = false;
  const {
    console,
    consoleBack,
    consoleFront,
    consoleFrontDetails,
    consoleLightRings,
    glass,
    ship,
    shipPanels,
  } = useGLTF("/baked/spaceship.glb").nodes;

  return (
    <group {...props} dispose={null}>
      <mesh
        geometry={glass.geometry}
        material={glassMaterial}
        renderOrder={1}
      ></mesh>
      <mesh geometry={ship.geometry} renderOrder={1}>
        <meshBasicMaterial map={shipTexture} depthTest={false} />
      </mesh>
      <mesh geometry={shipPanels.geometry} renderOrder={2}>
        <meshBasicMaterial map={shipTexture} depthTest={false} />
      </mesh>
      <group position={[0, 0.4, 0]}>
        <mesh geometry={consoleBack.geometry} renderOrder={3}>
          <meshBasicMaterial map={consoleTexture} depthTest={false} />
        </mesh>
        <mesh geometry={console.geometry} renderOrder={4}>
          <meshBasicMaterial map={consoleTexture} depthTest={false} />
        </mesh>
        <mesh geometry={consoleFront.geometry} renderOrder={5}>
          <meshBasicMaterial map={consoleTexture} depthTest={false} />
        </mesh>
        <mesh geometry={consoleFrontDetails.geometry} renderOrder={6}>
          <meshBasicMaterial map={consoleTexture} depthTest={false} />
        </mesh>
        <mesh geometry={consoleLightRings.geometry} renderOrder={7}>
          <colorShiftMaterial
            emissive={[1, 1, 1]}
            emissiveIntensity={30}
            color="green"
            time={clock.elapsedTime}
            speed={0.6}
            depthWrite={false}
            depthTest={false}
          />
        </mesh>
      </group>
    </group>
  );
}

useGLTF.preload("/baked/spaceship.glb");
